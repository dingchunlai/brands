<%= javascript_include_tag "jrails" %>
<style type="text/css">
.opmenu { padding:5px;height:20px;}
.opmenu a {display:block;float:right;height:20px;line-height:20px; padding:0 5px; border: 1px solid blue; color: red; text-decoration: none;}
.content{padding:5px;}
.content li{ float:left;padding:5px; text-align: center; border: 1px solid #999999; margin-right: 10px; margin-bottom: 5px; }
.content li img{ width:143px;height:123px;display:block; }
h3.title { padding: 5px; margin: 0; background-color: orange; width: 135px; height: 40px; }
#form { padding: 5px; }
</style>
<div id="container">
<h1>
  <% append_msg = '' %>
  <%= (case @img_type
        when "shop"
            append_msg = '门店照片尺寸为360*190像素，图片大小不超过200K'
            "门店"
        when "case"
            "产品"
        when "glory"
            "荣誉证书"
  end) + "图片管理"%>
  <br />
  <%= append_msg %>
</h1>
<%
    limit = Distributor::HY_PIC_UPLOAD_LIMIT[@img_type.to_sym]
    if @images.size < limit
%>
    <div class="opmenu">
      <%= link_to_remote '上传新图',
                         :url => distributor_user_upload_img_form_path(:type => @img_type),
                         :before => "$('#form').html('表单加载中...');$('#error').html('');",
                         :update => { :success => "form" },:failure => "$('#form').html('');$('#error').html('错误，请联系管理员!');", :html => { :id => "new_upload_link" }%>
    </div>
<% end %>
    <div id="error" class="clearfix"></div>
    <div id="form" class="clearfix">
    </div>
    <div class="content">
      <ul class="clearfix" id="img_list">
        <% unless @images.empty? %>
            <%= render :partial => "image", :collection => @images, :locals => { :img_type => @img_type } %>
        <% end %>
      </ul>
        <div class="clearfix"></div>
        <% unless @images.empty? %>
           <%= will_paginate @images, :class => "digg_pagination"  %>
        <% end %>
    </div>
</div>
<script src="http://js.51hejia.net/js/jquery.uploadify.v2.1.0.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/swfobject/2/swfobject.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function(){
    $("#cancel_edit").live("click", function(){
        $($(this).parent()).html('');
    });
  });
</script>